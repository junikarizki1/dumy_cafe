{% extends 'base.html' %} {% load static %} {% block content %}
<section class="book_section layout_padding">
  <div class="container">
    <div class="heading_container heading_center">
      <h2>Konfirmasi Pesanan</h2>
    </div>
    <div class="row mt-5">
      <div class="col-md-7">
        <h4>Data Pemesanan</h4>
        <hr />
        <form method="POST" action="{% url 'order:checkout' %}">
          {% csrf_token %}
          <div class="form-group">
            <label>Pilih Tipe Pesanan</label>
            <div class="custom-control custom-radio">
              <input
                type="radio"
                id="dineInRadio"
                name="order_type"
                value="Dine-In"
                class="custom-control-input"
                checked
              />
              <label class="custom-control-label" for="dineInRadio"
                >Makan di Tempat (Dine-In)</label
              >
            </div>
            <div class="custom-control custom-radio">
              <input
                type="radio"
                id="takeawayRadio"
                name="order_type"
                value="Takeaway"
                class="custom-control-input"
              />
              <label class="custom-control-label" for="takeawayRadio"
                >Bawa Pulang (Takeaway)</label
              >
            </div>
          </div>

          <div class="form-group" id="tableNumberGroup">
            <label for="tableNumber">Nomor Meja</label>
            <input
              type="text"
              class="form-control"
              name="table_number"
              id="tableNumberInput"
              placeholder="Contoh: 1A"
              required
            />
          </div>

          <div class="form-group mt-4">
            <label>Pilih Metode Pembayaran</label>
            <div class="custom-control custom-radio">
              <input
                type="radio"
                id="cashRadio"
                name="payment_method"
                value="Cash"
                class="custom-control-input"
                checked
              />
              <label class="custom-control-label" for="cashRadio"
                >Bayar di Kasir (Cash)</label
              >
            </div>
            <div class="custom-control custom-radio">
              <input
                type="radio"
                id="qrisRadio"
                name="payment_method"
                value="QRIS"
                class="custom-control-input"
              />
              <label class="custom-control-label" for="qrisRadio">QRIS</label>
            </div>
          </div>

          <div class="btn_box mt-4 mb-4">
            <button type="submit" class="btn btn-outline-warning">
              Konfirmasi
            </button>
          </div>
        </form>
      </div>

      <div class="col-md-5">
        <h4>Ringkasan Belanja</h4>
        <hr />
        <ul class="list-group mb-3">
          {% for item in cart_items %}
          <li
            class="list-group-item d-flex justify-content-between lh-condensed"
          >
            <div>
              <h6 class="my-0">{{ item.product.name }}</h6>
              <small class="text-muted">Qty: {{ item.quantity }}</small>
            </div>
            <span class="text-muted">Rp {{ item.subtotal|floatformat:0 }}</span>
          </li>
          {% endfor %}
          <li class="list-group-item d-flex justify-content-between bg-light">
            <span style="font-weight: bold">Total</span>
            <strong style="color: #ffbe33"
              >Rp {{ total_price|floatformat:0 }}</strong
            >
          </li>
        </ul>
      </div>
    </div>
  </div>
</section>
{% endblock content %} {% block javascript %}
<script>
  $(document).ready(function () {
    // Fungsi untuk menampilkan/menyembunyikan input nomor meja
    function toggleTableNumber() {
      if ($("#dineInRadio").is(":checked")) {
        $("#tableNumberGroup").show();
        $("#tableNumberInput").prop("required", true); // Wajib diisi jika Dine-In
      } else {
        $("#tableNumberGroup").hide();
        $("#tableNumberInput").prop("required", false); // Tidak wajib diisi jika Takeaway
      }
    }

    // Panggil fungsi saat halaman pertama kali dimuat
    toggleTableNumber();

    // Panggil fungsi setiap kali pilihan radio berubah
    $('input[name="order_type"]').on("change", function () {
      toggleTableNumber();
    });
  });
</script>
{% endblock javascript %}
